{{ $type := .Get 0 }}
{{ $repo := .Get 1 }}
{{ $number := .Get 2 }}
{{ $title := .Get 3 }}
{{ $html := .Get 4 }}

{{ $url_type := "" }}
{{ if eq $type "issue" }}
  {{ $url_type = "issues" }}
{{ else if eq $type "pr" }}
  {{ $url_type = "pull" }}
{{ else }}
  {{ errorf "Invalid type (issue/pr): %q" $type }}
{{ end }}

{{ if eq $html "paragraph" }}
<p class="gh-reference">
{{ else }}
<span class="gh-reference">
{{ end }}
  {{/* Icons taken from https://github.com/primer/octicons */}}
  {{ $icon := "" }}
  {{ if eq $type "issue" }}
    <svg class="gh-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path d="M8 9.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"/><path fill-rule="evenodd" d="M8 0a8 8 0 100 16A8 8 0 008 0zM1.5 8a6.5 6.5 0 1113 0 6.5 6.5 0 01-13 0z"/></svg>
  {{ else if eq $type "pr" }}
    <svg class="gh-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M7.177 3.073L9.573.677A.25.25 0 0110 .854v4.792a.25.25 0 01-.427.177L7.177 3.427a.25.25 0 010-.354zM3.75 2.5a.75.75 0 100 1.5.75.75 0 000-1.5zm-2.25.75a2.25 2.25 0 113 2.122v5.256a2.251 2.251 0 11-1.5 0V5.372A2.25 2.25 0 011.5 3.25zM11 2.5h-1V4h1a1 1 0 011 1v5.628a2.251 2.251 0 101.5 0V5A2.5 2.5 0 0011 2.5zm1 10.25a.75.75 0 111.5 0 .75.75 0 01-1.5 0zM3.75 12a.75.75 0 100 1.5.75.75 0 000-1.5z"/></svg>
  {{ end }}

  <a class="gh-title" href="https://github.com/{{ $repo }}/{{ $url_type }}/{{ $number }}" style="text-decoration: none;">{{ $title | markdownify }}
    <span class="gh-number">{{ $repo }}#{{ $number }}</span></a>
{{ if eq $html "paragraph" }}
</p>
{{ else }}
</span>
{{ end }}
